<div class = "glossary-entry">
<h3>n_divergent</h3>

<span class="help-block" style = "margin-top: 15px;">
  <em>Quick definition</em>
</span>
  
The number of leapfrog transitions with diverging error. Because NUTS terminates 
at the first divergence this will be either 0 or 1 for each iteration. 
The average value of <code>n_divergent</code> over all iterations is therefore 
the proportion of iterations with diverging error.

<h4>More details</h4>

Stan uses a symplectic integrator to approximate the exact solution of the 
Hamiltonian dynamics and when <code>stepsize</code> is too large relative 
to the curvature of the log posterior this approximation can diverge and 
threaten the validity of the sampler. <code>n_divergent</code> counts the 
number of iterations within a given sample that have diverged and any 
non-zero value suggests that the samples may be biased in which case
the step size needs to be decreased. Note that, because sampling is 
immediately terminated once a divergence is encountered, <code>n_divergent</code> 
should be only 0 or 1.
<br><br>
<strong>
If there are any post-warmup iterations for which <code>n_divergent = 1</code> 
then the results may be biased and should not be used. You should try rerunning 
the model with a higher target acceptance probability (which will decrease the
step size) until <code>n_divergent = 0</code> for all post-warmup iterations.
</strong>
</div>

